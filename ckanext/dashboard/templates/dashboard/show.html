{% extends "admin/base.html" %}

{% block page_title %}
    View Dashboard - {{ dashboard.title if dashboard else "Not Found" }}
{% endblock %}

{% block content %}
<!-- Load Tableau API only if needed -->
{% if dashboard.type == "tableau" %}
  <script type="module" src="https://public.tableau.com/javascripts/api/tableau.embedding.3.latest.min.js"></script>
{% endif %}

<!-- Generic BI Visualization Component -->
<tableau-viz id="tableauViz"       
  src='https://public.tableau.com/views/Superstore_embedded_800x800/Overview'      
  toolbar="bottom" hide-tabs>
</tableau-viz>
{{ super() }}
  {% if embeded_url %}
    <h3>Dashboard</h3>
    <iframe
      title="ckan_test"
      width="100%"
      height="541.25"
      src="{{embeded_url}}"
      frameborder="0"
      allowFullScreen="true">
    </iframe>
    <div style="display: flex; margin-bottom: 30px;">
      {% if report_url %}
        <a href="{{ report_url }}" style="margin-left: auto;" target="_blank">See this report in Power BI site...</a>
      {% else %}
        <i style="margin-left: auto;">No link to Power BI site has been added by the admin.</i>
      {% endif %}
    </div>
  {% endif %}

{% endblock %}